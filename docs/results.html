<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Energy - 3&nbsp; Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./d3graph.html" rel="next">
<link href="./data.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Energy</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/Amy0Shen/energy" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./d3graph.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusion</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#unveiling-energy-trends" id="toc-unveiling-energy-trends" class="nav-link active" data-scroll-target="#unveiling-energy-trends"><span class="header-section-number">3.1</span> <strong>Unveiling Energy Trends</strong></a></li>
  <li><a href="#balancing-production-and-consumption" id="toc-balancing-production-and-consumption" class="nav-link" data-scroll-target="#balancing-production-and-consumption"><span class="header-section-number">3.2</span> <strong>Balancing Production and Consumption</strong></a></li>
  <li><a href="#price-dynamics-and-supply-demand" id="toc-price-dynamics-and-supply-demand" class="nav-link" data-scroll-target="#price-dynamics-and-supply-demand"><span class="header-section-number">3.3</span> <strong>Price Dynamics and Supply-Demand</strong></a></li>
  <li><a href="#renewable-energys-impact-on-conventional-sources" id="toc-renewable-energys-impact-on-conventional-sources" class="nav-link" data-scroll-target="#renewable-energys-impact-on-conventional-sources"><span class="header-section-number">3.4</span> Renewable Energyâ€™s impact on Conventional Sources</a></li>
  <li><a href="#carbon-emissions-and-energy-mix" id="toc-carbon-emissions-and-energy-mix" class="nav-link" data-scroll-target="#carbon-emissions-and-energy-mix"><span class="header-section-number">3.5</span> <strong>Carbon Emissions and Energy Mix</strong></a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/Amy0Shen/energy/edit/main/results.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/Amy0Shen/energy/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The data range of all data tables we use is from 1973.1 to 2023.8. However, due to the existence of missing values in early data and the large amount of total data, we mainly consider the data of the past thirty years, that is, the data from 1993 to 2023.</p>
<section id="unveiling-energy-trends" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="unveiling-energy-trends"><span class="header-section-number">3.1</span> <strong>Unveiling Energy Trends</strong></h2>
<pre><code>Data Source: Utilize "Table_1.2" and "Table_1.3".

Techniques: Implement stacked histograms and time series analysis to depict consumption trends of different energy sources over time. Visualize shifts in energy consumption patterns, highlighting preferences across diverse energy sources.</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<p>Firstly, based on Table_1.3, consumption values of various types of energy from January 1973 to August 2023 are obtainable. The average value is taken for each year, and data from the last thirty years are selected, specifically from 1993 to 2023.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>production_m <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_1.2_Primary_Energy_Production_by_Source.xlsx"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>production_m<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(production_m<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>consumption_m <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_1.3_Primary_Energy_Consumption_by_Source.xlsx"</span>)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>consumption_m<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(consumption_m<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>consp_date <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption_m, Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(consp_date) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Coal"</span>, <span class="st">"Gas"</span>, <span class="st">"Petroleum"</span>, <span class="st">"Total Fossil"</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># get the annual value</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>production_m<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(production_m<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> production_m <span class="sc">%&gt;%</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>consumption_m<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(consumption_m<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption_m <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There are two main categories of energy consumption: conventional energy, including Fossil Fuels such as coal, oil, and natural gas, and renewable energy, including wind, solar, and nuclear power. Utilizing a line graph, the annual average values of Fossil Energy Consumption, Renewable Energy Consumption, and Total Energy Consumption are depicted, revealing the overall changes in US energy consumption over the past thirty years.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>consumption_30y <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption, year <span class="sc">&gt;=</span> <span class="dv">1993</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2023</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>consumption_30y_total <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption_30y, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">13</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(consumption_30y_total) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Fossil"</span>, <span class="st">"Renewable"</span>, <span class="st">"Total"</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>consumption_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(consumption_30y_total, <span class="at">id.vars =</span> <span class="st">"Year"</span>, <span class="at">variable.name =</span> <span class="st">"Energy_Type"</span>, <span class="at">value.name =</span> <span class="st">"Consumption"</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(consumption_melted, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Consumption, <span class="at">color =</span> Energy_Type, <span class="at">group =</span> Energy_Type)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Consumption"</span>, <span class="at">title =</span> <span class="st">"Energy Consumption Trends Over Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$x
[1] "Year"

$y
[1] "Consumption"

$title
[1] "Energy Consumption Trends Over Years"

attr(,"class")
[1] "labels"</code></pre>
</div>
</div>
<p>From the graph, itâ€™s evident that the total energy consumption in the US is still dominated by traditional Fossil fuels, while Renewable energy shows an upward trend since the late twentieth century.</p>
<p>As the total energy consumption in the United States continues to be predominantly reliant on traditional Fossil fuels, we will now focus on analyzing Fossil energy. Fossil energy primarily comprises three components: coal, petroleum, and natural gas.</p>
<p>Drawing a stacked histogram reveals the changing trends in US Fossil energy consumption over the past thirty years. Simultaneously, it depicts the proportions and trends of consumption for the three traditional energy sources.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fossil <span class="ot">&lt;-</span> <span class="fu">subset</span>(consumption_30y, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(fossil) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Coal"</span>, <span class="st">"Gas"</span>, <span class="st">"Petroleum"</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fossil_melted <span class="ot">&lt;-</span> fossil <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">"Fossil_Type"</span>, <span class="at">values_to =</span> <span class="st">"Consumption"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fossil_melted, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Consumption, <span class="at">fill =</span> Fossil_Type)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Consumption"</span>, <span class="at">title =</span> <span class="st">"Fossil Fuel Consumption Over the Years"</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>From the graph, itâ€™s evident that Petroleum constitutes the primary component of Fossil energy, and its consumption has remained relatively stable over the past thirty years. Following Petroleum is Gas, which has shown a steady increase in consumption year by year. The smallest proportion is attributed to Coal, which exhibits a declining consumption trend over the same period.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>consp_date<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">year</span>(consp_date<span class="sc">$</span>Month)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>consp_date<span class="sc">$</span>Month <span class="ot">&lt;-</span> <span class="fu">month</span>(consp_date<span class="sc">$</span>Month)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>consp_date2 <span class="ot">&lt;-</span> consp_date <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Year"</span>), <span class="at">names_to =</span> <span class="st">"TYPE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">TYPE =</span> forcats<span class="sc">::</span><span class="fu">fct_reorder2</span>(TYPE, Month, value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, we aim to investigate whether energy consumption is associated with seasonal variations, such as higher demands for heating during cold winters and increased cooling needs in hot summers, both leading to escalated energy consumption.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(consp_date2, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> value, <span class="at">colour =</span> TYPE)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Month"</span>, <span class="at">y =</span> <span class="st">"Energy Consumption"</span>, <span class="at">title =</span> <span class="st">"Monthly Fossil Consumption Over Time"</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Month) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Hence, employing time series analysis, we extracted the changes in Fossil fuel consumption over the past thirty years for each month.</p>
<p>The results from the graph indicate that in comparison to other months, Fossil fuel consumption is notably higher in December and January, as well as in July and August. This aligns with our assumptions regarding seasonal trends.</p>
</section>
<section id="balancing-production-and-consumption" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="balancing-production-and-consumption"><span class="header-section-number">3.2</span> <strong>Balancing Production and Consumption</strong></h2>
<pre><code>Data Source: Utilize "Table_1.1".

Techniques: Utilize scatterplot and stacked histogram combined with a line chart to analyze the relationship between energy production growth and consumption trends. Visual representation showcasing alignment or divergence between production and consumption trends.</code></pre>
<p>Our second inquiry aims to investigate the relationship between energy production and consumption. In theory, energy production should exceed or at least match energy consumption. We selected Table_1.1, which contains data on energy production, consumption, and related factors.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>total_m <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_1.1_Primary_Energy_Overview.xlsx"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>total_m<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(total_m<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>total_m<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(total_m<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>total <span class="ot">&lt;-</span> total_m <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>prod.vs.consp <span class="ot">&lt;-</span> <span class="fu">subset</span>(total, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">13</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(prod.vs.consp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Production"</span>, <span class="st">"Consumption"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Initially, by plotting a scatter plot, we aimed to approximate the annual relationship between energy consumption and production from 1973 to the present. However, the results did not conform to the â€˜production â‰¥ consumptionâ€™ relationship.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>prod.vs.consp<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(prod.vs.consp<span class="sc">$</span>Year)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>decade <span class="ot">&lt;-</span> prod.vs.consp <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1979</span> <span class="sc">~</span> <span class="st">"1970s"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1980</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1989</span> <span class="sc">~</span> <span class="st">"1980s"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1990</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1999</span> <span class="sc">~</span> <span class="st">"1990s"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2000</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2009</span> <span class="sc">~</span> <span class="st">"2000s"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2010</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2019</span> <span class="sc">~</span> <span class="st">"2010s"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2029</span> <span class="sc">~</span> <span class="st">"2020s"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(Year) </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(decade, <span class="at">x =</span> <span class="sc">~</span>Production, <span class="at">y =</span> <span class="sc">~</span>Consumption,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="sc">~</span><span class="fu">as.factor</span>(Decade), <span class="at">text=</span> <span class="sc">~</span>Year,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">hoverinfo =</span> <span class="st">'text'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>No trace type specified:
  Based on info supplied, a 'scatter' trace seems appropriate.
  Read more about this trace type -&gt; https://plotly.com/r/reference/#scatter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>No scatter mode specifed:
  Setting the mode to markers
  Read more about this attribute -&gt; https://plotly.com/r/reference/#scatter-mode</code></pre>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1275b37e75e580896bba" style="width:100%;height:325px;"></div>
<script type="application/json" data-for="htmlwidget-1275b37e75e580896bba">{"x":{"visdat":{"4f387271304f":["function () ","plotlyVisDat"]},"cur_data":"4f387271304f","attrs":{"4f387271304f":{"x":{},"y":{},"text":{},"hoverinfo":"text","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Production"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Consumption"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[5.1329163333333332,5.0127048333333333,4.9283746666666666,4.9583369166666662,5.0314878333333333,5.0891511666666664,5.3216091666666667],"y":[6.1430429166666665,5.9811112499999997,5.8157060000000005,6.1596725000000001,6.3604105833333335,6.4929769999999998,6.5683728333333331],"text":[1973,1974,1975,1976,1977,1978,1979],"hoverinfo":["text","text","text","text","text","text","text"],"type":"scatter","mode":"markers","name":"1970s","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5.430377833333333,5.4176227500000005,5.3577336666666664,5.1366570833333336,5.5388202499999997,5.4662881666666667,5.4074657500000001,5.4715847499999999,5.6046255,5.6046666666666667],"y":[6.3362920000000003,6.1796428333333333,5.90107275,5.8740945833333331,6.1864841666666663,6.1890908333333332,6.2049157499999996,6.4301430833333333,6.7521610000000001,6.8926897499999997],"text":[1980,1981,1982,1983,1984,1985,1986,1987,1988,1989],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"type":"scatter","mode":"markers","name":"1980s","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"line":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5.7075204166666662,5.6795591666666665,5.6688028333333333,5.5165066666666664,5.729365416666667,5.7388681666666663,5.8253604166666664,5.8224450000000001,5.8756554999999997,5.7810542500000004],"y":[6.8547103333333332,6.8512589166666666,6.9864456666666666,7.0993815833333338,7.2544884999999999,7.389106833333333,7.6170805000000001,7.6631284166666669,7.7168935833333334,7.8527478333333338],"text":[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"type":"scatter","mode":"markers","name":"1990s","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"line":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5.7718295833333331,5.835612583333333,5.7244234166666672,5.6546992500000002,5.6833551666666668,5.6146891666666665,5.7100816666666665,5.7841515000000001,5.9198254166666668,5.8563261666666664],"y":[8.0579083333333337,7.8679760833333336,7.9646195833333335,7.9838749166666663,8.1694307500000001,8.1750769166666668,8.1029119999999999,8.2470927500000002,8.0538939999999997,7.6355356666666667],"text":[2000,2001,2002,2003,2004,2005,2006,2007,2008,2009],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"type":"scatter","mode":"markers","name":"2000s","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"line":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[6.0446919166666664,6.2668498333333336,6.3788780833333334,6.5820615,7.0660119166666666,7.1140910000000002,6.7541441666666664,7.0309984166666668,7.6635609999999996,8.133629916666667],"y":[7.928483833333333,7.83053825,7.6397769166666665,7.8544334999999998,7.9445722500000002,7.873678833333333,7.8410329166666664,7.8251425833333332,8.117070833333333,8.0502866666666666],"text":[2010,2011,2012,2013,2014,2015,2016,2017,2018,2019],"hoverinfo":["text","text","text","text","text","text","text","text","text","text"],"type":"scatter","mode":"markers","name":"2010s","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"line":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[7.6551150833333335,7.8201120833333331,8.2104733333333328,8.50333425],"y":[7.4043663333333329,7.7802419166666663,7.8992230833333332,7.8081318749999999],"text":[2020,2021,2022,2023],"hoverinfo":["text","text","text","text"],"type":"scatter","mode":"markers","name":"2020s","marker":{"color":"rgba(255,217,47,1)","line":{"color":"rgba(255,217,47,1)"}},"textfont":{"color":"rgba(255,217,47,1)"},"error_y":{"color":"rgba(255,217,47,1)"},"error_x":{"color":"rgba(255,217,47,1)"},"line":{"color":"rgba(255,217,47,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>prod.vs.consp2 <span class="ot">&lt;-</span> <span class="fu">subset</span>(total, year <span class="sc">&gt;=</span> <span class="dv">1993</span>, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">13</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(prod.vs.consp2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Production"</span>, <span class="st">"Import"</span>, <span class="st">"Storage.Change"</span>, <span class="st">"Consumption"</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>prod.vs.consp2_melted <span class="ot">&lt;-</span> <span class="fu">melt</span>(prod.vs.consp2, <span class="at">id.vars =</span> <span class="st">"Year"</span>, <span class="at">variable.name =</span> <span class="st">"Type"</span>, <span class="at">value.name =</span> <span class="st">"Value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>bar_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(prod.vs.consp2_melted[prod.vs.consp2_melted<span class="sc">$</span>Type <span class="sc">!=</span> <span class="st">"Consumption"</span>, ], </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">fill =</span> Type)) <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"stack"</span>, <span class="at">width =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Value"</span>, <span class="at">title =</span> <span class="st">"Comparison of Production and Consumption"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>line_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(prod.vs.consp2_melted, Type <span class="sc">==</span> <span class="st">"Consumption"</span>), </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"#f15c5c"</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Consumption"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> bar_plot <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">data =</span> prod.vs.consp2_melted[prod.vs.consp2_melted<span class="sc">$</span>Type <span class="sc">==</span> <span class="st">"Consumption"</span>, ], </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Value, <span class="at">group =</span> <span class="dv">1</span>), </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">color =</span> <span class="st">"#f15c5c"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Consequently, we delved deeper into the dataset, considering that actual energy production should encompass energy imports and the consumption of energy stocks. Hence, we plotted a stacked histogram illustrating energy production, imports, and stock variation, comparing them with energy consumption.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>combined_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>This analysis revealed that total production exceeds or matches consumption. Additionally, our observation indicated that over the past thirty years, the United States primarily relied on domestic energy production. Furthermore, the net energy import quantity in the US has shown a declining trend since the late twentieth century. In recent years, the net import quantity has turned negative, indicating that energy exports exceed energy imports.</p>
</section>
<section id="price-dynamics-and-supply-demand" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="price-dynamics-and-supply-demand"><span class="header-section-number">3.3</span> <strong>Price Dynamics and Supply-Demand</strong></h2>
<pre><code>Data Source: Utilize "Table_9.1", "Table_9.10" and "Table_1.1".

Techniques: Employ boxplots, scatterplots, and heatmaps to illustrate price fluctuations and their correlation with supply-demand dynamics. Visual representations elucidating changes in price dynamics and their relationship with supply and demand shifts.</code></pre>
<p>Our third inquiry focuses on investigating the correlation between energy prices and supply-demand dynamics. Primarily, we examine the price fluctuations of crude oil and natural gas.</p>
<p>Table_9.1 contains various crude oil prices, explained as follows:</p>
<ol type="1">
<li><p><strong>Crude Oil Domestic First Purchase Price (Dom.1stPur):</strong> Initial cost for domestically produced crude oil purchased by local buyers, representing the first buyerâ€™s price.</p></li>
<li><p><strong>Free on Board Cost of Crude Oil Imports (FOB.Cost.Import):</strong> Price of crude oil at shipment, typically at the export port, covering its cost and expenses until loaded onto the ship.</p></li>
<li><p><strong>Landed Cost of Crude Oil Imports (Landed.Cost.Import):</strong> Total cost of imported crude oil at the destination port, including FOB costs, duties, taxes, handling, and transportation.</p></li>
<li><p><strong>Refiner Acquisition Cost of Crude Oil, Domestic (Ref.Acq.Cost.Dom):</strong> Cost for refiners purchasing domestically produced crude oil, encompassing expenses related to sourcing from domestic suppliers.</p></li>
<li><p><strong>Refiner Acquisition Cost of Crude Oil, Imported (Ref.Acq.Cost.Imp):</strong> Expenses for refiners purchasing imported crude oil from international sources.</p></li>
<li><p><strong>Refiner Acquisition Cost of Crude Oil, Composite (CompRef.Acq.Cost):</strong> Total cost for refiners purchasing both domestic and imported crude oil, presenting an overall cost considering a blend of sources.</p></li>
</ol>
<p>Table_9.10 encompasses various natural gas prices, explained as follows:</p>
<ol type="1">
<li><p><strong>Natural Gas Price, Citygate (Citygate):</strong> Cost of natural gas at urban distribution points.</p></li>
<li><p><strong>Natural Gas Price, Delivered to Consumers, Residential (Custom.Resid):</strong> Cost of natural gas delivered to residential consumers.</p></li>
<li><p><strong>Natural Gas Price, Delivered to Consumers, Commercial (Custom.Commer):</strong> Cost of natural gas delivered to commercial consumers or businesses.</p></li>
<li><p><strong>Percentage of Commercial Sector Consumption for Which Price Data Are Available (Perc1):</strong> Percentage of commercial gas usage with available price data.</p></li>
<li><p><strong>Natural Gas Price, Delivered to Consumers, Industrial (Custom.Industr):</strong> Cost of gas supplied to industries.</p></li>
<li><p><strong>Percentage of Industrial Sector Consumption for Which Price Data Are Available (Perc2):</strong> Percentage of industrial gas usage with available price data.</p></li>
<li><p><strong>Natural Gas Price, Electric Power Sector (Elec):</strong> Cost of gas supplied specifically to the power generation sector.</p></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_9.1_Crude_Oil_Price_Summary.xlsx"</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>oil_price<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(oil_price<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># get the annual value</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>oil_price<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(oil_price<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>oil_price_y <span class="ot">&lt;-</span> oil_price <span class="sc">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1993</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(oil_price_y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Dom.1stPur"</span>, <span class="st">"FOB.Cost.Import"</span>, <span class="st">"Landed.Cost.Import"</span>, <span class="st">"Ref.Acq.Cost.Dom"</span>, <span class="st">"Ref.Acq.Cost.Imp"</span>, <span class="st">"CompRef.Acq.Cost"</span>)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>oil_price_y_melted <span class="ot">&lt;-</span> oil_price_y <span class="sc">%&gt;%</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">"Price_Type"</span>, <span class="at">values_to =</span> <span class="st">"Price"</span>)</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co"># read the data</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>gas_price <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_9.10_Natural_Gas_Prices.xlsx"</span>)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>gas_price<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(gas_price<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co"># get the annual value</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>gas_price<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">substr</span>(gas_price<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>gas_price_y <span class="ot">&lt;-</span> gas_price <span class="sc">%&gt;%</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1993</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(gas_price_y) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Citygate"</span>, <span class="st">"Custom.Resid"</span>, <span class="st">"Custom.Commer"</span>, <span class="st">"Perc1"</span>, <span class="st">"Custom.Industr"</span>, <span class="st">"Perc2"</span>, <span class="st">"Elec"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>gas_price_y  <span class="ot">&lt;-</span> <span class="fu">subset</span>(gas_price_y, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>))</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>oil_price_y_melted <span class="ot">&lt;-</span> oil_price_y <span class="sc">%&gt;%</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">"Price_Type"</span>, <span class="at">values_to =</span> <span class="st">"Oil_Price"</span>)</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>gas_price_y_melted <span class="ot">&lt;-</span> gas_price_y <span class="sc">%&gt;%</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">"Price_Type"</span>, <span class="at">values_to =</span> <span class="st">"Gas_Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Firstly, we used boxplots to assess the approximate distribution of oil and gas prices, and combined them with line graphs to determine the price trends.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(oil_price_y_melted, <span class="fu">aes</span>(<span class="at">x =</span> Price_Type,<span class="at">y =</span> Oil_Price)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Multiple boxplots of Oil Price"</span>) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Oil Price"</span>, <span class="at">x =</span> <span class="st">"Price Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gas_price_y_melted, <span class="fu">aes</span>(<span class="at">x =</span> Price_Type,<span class="at">y =</span> Gas_Price)) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Multiple boxplots of Gas Price"</span>) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Gas Price"</span>, <span class="at">x =</span> <span class="st">"Price Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="960"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(oil_price_y_melted, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Oil_Price, <span class="at">color =</span> Price_Type, <span class="at">group =</span> Price_Type)) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Oil Price"</span>, <span class="at">title =</span> <span class="st">"Oil Price Trends Over Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
â„¹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="1152"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gas_price_y_melted, <span class="fu">aes</span>(<span class="at">x =</span> Year, <span class="at">y =</span> Gas_Price, <span class="at">color =</span> Price_Type, <span class="at">group =</span> Price_Type)) <span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Year"</span>, <span class="at">y =</span> <span class="st">"Gas Price"</span>, <span class="at">title =</span> <span class="st">"Gas Price Trends Over Years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>From the graphs, itâ€™s evident that different types of oil prices are close to each other and follow similar trends. There was a significant surge from 1993 to 2008, followed by fluctuations after 2008.</p>
<p>As for gas prices, various types exhibit similar changing patterns, witnessing a substantial increase from 1993 to 2008. However, thereâ€™s a noticeable difference in the values of different prices. Among these, the price of gas delivered to residential users is the highest. Possible reasons for this include:</p>
<ol type="1">
<li>Residential users typically have a stable and indispensable demand for natural gas, particularly for heating and cooking. This relatively fixed demand allows natural gas suppliers to set relatively higher prices.</li>
<li>Supplying natural gas to residential areas may involve more pipelines and infrastructure, with additional logistics and investment costs that might be factored into user prices.</li>
<li>Providing natural gas services to residential users might require more service support and guarantees, such as ensuring continuous supply and handling emergency situations. These additional services might contribute to the increased prices.</li>
</ol>
<p>Next, we aim to investigate whether the prices of oil and gas, being primary energy sources, are influenced by the supply and demand of energy.</p>
<p>We selected energy production, energy imports, and changes in energy stock as energy supply indicators. For oil prices, considering the close resemblance among the six types of oil prices, we opted to use the average of these six prices as the representative oil price. Concerning gas prices, we chose the initial price, specifically the price at the urban distribution point, as our reference.</p>
<p>We aim to construct a scatter plot to explore the relationship between energy supply, energy consumption, oil price, and gas price.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>price.vs.supply.demand <span class="ot">&lt;-</span> <span class="fu">merge</span>(prod.vs.consp2, oil_price_y, <span class="at">by =</span> <span class="st">'Year'</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>price.vs.supply.demand <span class="ot">&lt;-</span> <span class="fu">merge</span>(price.vs.supply.demand, gas_price_y, <span class="at">by =</span> <span class="st">'Year'</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>price.vs.supply.demand<span class="sc">$</span>Supply <span class="ot">&lt;-</span> price.vs.supply.demand<span class="sc">$</span>Production <span class="sc">+</span> price.vs.supply.demand<span class="sc">$</span>Import <span class="sc">+</span> price.vs.supply.demand<span class="sc">$</span>Storage.Change</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>price.vs.supply.demand <span class="ot">&lt;-</span> price.vs.supply.demand <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Oil_Price =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">11</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>corr.price.vs.supply.demand <span class="ot">&lt;-</span> price.vs.supply.demand <span class="sc">%&gt;%</span> </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Supply, Consumption, Oil_Price, Citygate)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(corr.price.vs.supply.demand)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>From the graph, itâ€™s evident that thereâ€™s an unmistakable linear relationship between supply and consumption. The prices of oil and gas show a proportional correlation with the supply and demand of energy.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>total_pro_consp <span class="ot">&lt;-</span> <span class="fu">subset</span>(total_m, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">13</span>), Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(total_pro_consp) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"Primary.Pro"</span>, <span class="st">"Import"</span>, <span class="st">"Stock"</span>, <span class="st">"Consumption"</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>oil_price <span class="ot">&lt;-</span> <span class="fu">subset</span>(oil_price, Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>gas_price <span class="ot">&lt;-</span> <span class="fu">subset</span>(gas_price, Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>total_price_pro_consp <span class="ot">&lt;-</span> <span class="fu">merge</span>(total_pro_consp, oil_price, <span class="at">by =</span> <span class="st">'Month'</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>total_price_pro_consp <span class="ot">&lt;-</span> <span class="fu">merge</span>(total_price_pro_consp, gas_price, <span class="at">by =</span> <span class="st">'Month'</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>total_price_pro_consp <span class="ot">&lt;-</span> total_price_pro_consp <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Oil_Price =</span> <span class="fu">mean</span>(<span class="fu">c_across</span>(<span class="dv">6</span><span class="sc">:</span><span class="dv">11</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>total_price_pro_consp<span class="sc">$</span>Supply <span class="ot">&lt;-</span> total_price_pro_consp<span class="sc">$</span>Primary.Pro <span class="sc">+</span> total_price_pro_consp<span class="sc">$</span>Import <span class="sc">+</span> total_price_pro_consp<span class="sc">$</span>Stock</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_price_pro_consp, <span class="fu">aes</span>(Supply, Oil_Price)) <span class="sc">+</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Energy Supply vs Oil Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_price_pro_consp, <span class="fu">aes</span>(Consumption, Oil_Price)) <span class="sc">+</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Energy Demand vs Oil Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-19-2.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_price_pro_consp, <span class="fu">aes</span>(Supply, <span class="st">`</span><span class="at">Natural.Gas.Price,.Citygate</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Energy Supply vs Gas Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-19-3.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(total_price_pro_consp, <span class="fu">aes</span>(Consumption, <span class="st">`</span><span class="at">Natural.Gas.Price,.Citygate</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hex</span>() <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Energy Demand vs Gas Price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-19-4.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Creating a heatmap depicting the relationship between monthly energy supply and demand along with oil and gas prices, we observe that the energy supply and demand are concentrated around the 7th and 8th months, coinciding with gas prices concentrated between 2.5 and 6.</p>
<p>In contrast, the heatmap depicting the relationship between oil price and supply and demand doesnâ€™t show a clear trend. This might be due to significant fluctuations in oil prices over the last thirty years. There are likely other factors that exert a more significant influence on oil prices, such as political factors, resulting in the lack of a distinct trend in the heatmap.</p>
</section>
<section id="renewable-energys-impact-on-conventional-sources" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="renewable-energys-impact-on-conventional-sources"><span class="header-section-number">3.4</span> Renewable Energyâ€™s impact on Conventional Sources</h2>
<pre><code>Data Source: Utilize "Table_10.1", "Table_1.2" and "Table_1.3" from the dataset.

Techniques: Utilize parallel coordinate plots to compare the increasing share of renewables with traditional energy sources. Visual elucidation of potential substitution effects between renewable and conventional sources..</code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'GGally':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€
âœ” purrr   1.0.2     âœ” stringr 1.5.0
âœ” readr   2.1.4     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– plotly::filter() masks dplyr::filter(), stats::filter()
âœ– dplyr::lag()     masks stats::lag()
â„¹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggalluvial)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>energy <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_1.1_Primary_Energy_Overview.xlsx"</span>, <span class="at">sep.names =</span> <span class="st">" "</span>)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>energy<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(energy<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>energy <span class="ot">&lt;-</span> energy <span class="sc">|&gt;</span> <span class="fu">filter</span>(Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;</span> <span class="st">'2023-01-01'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We are concerned about the trend over years, not the trend within years, so to further reduce the number of data points we have, we will sum up the months to get yearly energy production and consumption.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>energy<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">format</span>(energy<span class="sc">$</span>Month,<span class="st">"%Y"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>yearlyenergy <span class="ot">&lt;-</span> energy <span class="sc">|&gt;</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We try to draw a parallel coordinate plot with the fossil fuels vs renewable energy consumption and production.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>energy_t <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(yearlyenergy[<span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(energy_t) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yearlyenergy<span class="sc">$</span>Year)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>energy_t <span class="ot">&lt;-</span> energy_t[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">11</span>), ]</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>energy_t<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">word</span>(<span class="fu">rownames</span>(energy_t), <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(energy_t, <span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(energy_t)<span class="sc">-</span><span class="dv">1</span>), <span class="at">groupColumn =</span> <span class="st">'type'</span>, <span class="at">scale =</span> <span class="st">"globalminmax"</span>, <span class="at">alpha=</span><span class="fl">1.0</span>,) <span class="sc">+</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Fossil Fuels vs Renewable Energy Consumption and Production"</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Time"</span>) <span class="sc">+</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Type"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>We can see that fossil fuels consumption decreased while the production increased. The consumption and production of renewable energy is increases over the years, but it is hard to say whether it affects that of fossil fuels, as it is only a small amount. In order to see more clearly the relationship, we decide to turn the production and consumption into proportion of total energy production and consumption, and compare the production and consumption separately.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Fossil Fuels Production</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Fossil Fuels Production</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Production</span><span class="st">`</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Nuclear Electric Power Production</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Nuclear Electric Power Production</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Production</span><span class="st">`</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Renewable Energy Production</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Renewable Energy Production</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Production</span><span class="st">`</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(yearlyenergy[, <span class="fu">c</span>(<span class="st">"Scaled Fossil Fuels Production"</span>, <span class="st">"Scaled Renewable Energy Production"</span>, <span class="st">"Scaled Nuclear Electric Power Production"</span>)]))</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(production) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yearlyenergy<span class="sc">$</span>Year)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>production<span class="sc">$</span>Types <span class="ot">&lt;-</span> <span class="fu">rownames</span>(production)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>production <span class="ot">&lt;-</span> production <span class="sc">|&gt;</span> </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(production)<span class="sc">-</span><span class="dv">1</span>), <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Production"</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(production,</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Time), <span class="at">stratum =</span> Types, <span class="at">alluvium =</span> Types, </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Production,</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Types, <span class="at">label =</span> Types))<span class="sc">+</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>()<span class="sc">+</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Fossil Fuels Consumption</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Fossil Fuels Consumption</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Consumption</span><span class="st">`</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Nuclear Electric Power Consumption</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Nuclear Electric Power Consumption</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Consumption</span><span class="st">`</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Renewable Energy Consumption</span><span class="st">`</span> <span class="ot">&lt;-</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Renewable Energy Consumption</span><span class="st">`</span> <span class="sc">/</span> yearlyenergy<span class="sc">$</span><span class="st">`</span><span class="at">Total Primary Energy Consumption</span><span class="st">`</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(yearlyenergy[, <span class="fu">c</span>(<span class="st">"Scaled Fossil Fuels Consumption"</span>, <span class="st">"Scaled Renewable Energy Consumption"</span>, <span class="st">"Scaled Nuclear Electric Power Consumption"</span>)]))</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(consumption) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(yearlyenergy<span class="sc">$</span>Year)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>consumption<span class="sc">$</span>Types <span class="ot">&lt;-</span> <span class="fu">rownames</span>(consumption)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">|&gt;</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(consumption)<span class="sc">-</span><span class="dv">1</span>), <span class="at">names_to =</span> <span class="st">"Time"</span>, <span class="at">values_to =</span> <span class="st">"Consumption"</span>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(consumption,</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Time), <span class="at">stratum =</span> Types, <span class="at">alluvium =</span> Types, </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Consumption,</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> Types, <span class="at">label =</span> Types))<span class="sc">+</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_stratum</span>(<span class="at">alpha =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_alluvium</span>()<span class="sc">+</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"stratum"</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Now we can see that fossil fuel production does not show a decreasing trend as renewable energy production increase. However, the consumption of both does seem to have a negative correlation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>renew_m <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>renew_m<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(renew_m<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>renew_m <span class="ot">&lt;-</span> <span class="fu">subset</span>(renew_m, Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(renew_m) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Month"</span>, <span class="st">"wood.pro"</span>, <span class="st">"biofuel.pro"</span>, <span class="st">"biomass.total.pro"</span>, <span class="st">"renew.pro"</span>, <span class="st">"hydro.consp"</span>, <span class="st">"geother.consp"</span>, <span class="st">"solar.consp"</span>, <span class="st">"wind.consp"</span>, <span class="st">"wood.consp"</span>, <span class="st">"waste.consp"</span>, <span class="st">"biofuel.consp"</span>, <span class="st">"biomass.total.consp"</span>, <span class="st">"renew.consp"</span>)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># get the annual value</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>renew_m<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">substr</span>(renew_m<span class="sc">$</span>Month, <span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>renew <span class="ot">&lt;-</span> renew_m <span class="sc">%&gt;%</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>renew_m <span class="ot">&lt;-</span> renew_m <span class="sc">%&gt;%</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Decade =</span> <span class="fu">case_when</span>(</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1970</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1979</span> <span class="sc">~</span> <span class="st">"1970s"</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1980</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1989</span> <span class="sc">~</span> <span class="st">"1980s"</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">1990</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">1999</span> <span class="sc">~</span> <span class="st">"1990s"</span>,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2000</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2009</span> <span class="sc">~</span> <span class="st">"2000s"</span>,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2010</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2019</span> <span class="sc">~</span> <span class="st">"2010s"</span>,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">&gt;=</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Year <span class="sc">&lt;=</span> <span class="dv">2029</span> <span class="sc">~</span> <span class="st">"2020s"</span>,</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">as.character</span>(Year) </span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The types of new energy include wood, biofuel, geothermal, solar, hydro, and wind power. Next, we aim to utilize a parallel coordinate plot to explore the proportions of these new energy types and their trends over time.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggparcoord</span>(renew_m, <span class="at">columns=</span><span class="dv">2</span><span class="sc">:</span><span class="dv">14</span>, <span class="at">groupColumn=</span><span class="dv">16</span>, <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">scale=</span><span class="st">'uniminmax'</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">splineFactor=</span><span class="dv">10</span>, </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">"Modified parallel coordinate plot for Renewable Energy Source"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>From the graph, itâ€™s evident that there are significant differences in the distribution of various new energy types between different eras. Overall, after 2010, both the production and consumption of new energy surpassed the levels from 1990 to 2010.</p>
<p>From the perspective of different new energy types, after 2010 compared to the period between 1990 and 2010, there has been an increase in the production and consumption of geothermal, solar, and biomass energy. This discovery aligns with our understanding of technological progress.</p>
<p>Additionally, there has been a decrease in the consumption of wood and waste. The likely reason for this reduction is that the primary method of energy production from wood and waste involves combustion processes that generate a significant amount of carbon dioxide. Consequently, these methods of producing energy from wood and waste are gradually being replaced.</p>
<p>The following code is used to generate the dataset used for the interactive plot.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> yearlyenergy[, <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Total Fossil Fuels Consumption"</span>, <span class="st">"Nuclear Electric Power Consumption"</span>, <span class="st">"Total Renewable Energy Consumption"</span>)]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>consumption <span class="ot">&lt;-</span> consumption <span class="sc">|&gt;</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">"Type"</span>, <span class="at">values_to =</span> <span class="st">"Consumption"</span>)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>consumption_scaled <span class="ot">&lt;-</span> yearlyenergy[, <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Scaled Fossil Fuels Consumption"</span>, <span class="st">"Scaled Renewable Energy Consumption"</span>, <span class="st">"Scaled Nuclear Electric Power Consumption"</span>)]</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(consumption_scaled) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Total Fossil Fuels Consumption"</span>, <span class="st">"Nuclear Electric Power Consumption"</span>, <span class="st">"Total Renewable Energy Consumption"</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>yearlyconsumption <span class="ot">&lt;-</span> consumption_scaled <span class="sc">|&gt;</span> </span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">names_to =</span> <span class="st">"Type"</span>, <span class="at">values_to =</span> <span class="st">"Scaled Consumption"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(consumption, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Type"</span>))</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>yearlyconsumption_sorted <span class="ot">&lt;-</span> yearlyconsumption <span class="sc">|&gt;</span> </span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Total Renewable Energy Consumption"</span>, <span class="st">"Nuclear Electric Power Consumption"</span>, <span class="st">"Total Fossil Fuels Consumption"</span>), Type)</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>yearlyconsumption_sorted<span class="sc">$</span>Consumption <span class="ot">&lt;-</span> <span class="fu">format</span>(yearlyconsumption_sorted<span class="sc">$</span>Consumption, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>yearlyconsumption_sorted<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Consumption</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">format</span>(yearlyconsumption_sorted<span class="sc">$</span><span class="st">`</span><span class="at">Scaled Consumption</span><span class="st">`</span>, <span class="at">digits =</span> <span class="dv">5</span>)</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(yearlyconsumption_sorted, <span class="st">"Yearly Consumption.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="carbon-emissions-and-energy-mix" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="carbon-emissions-and-energy-mix"><span class="header-section-number">3.5</span> <strong>Carbon Emissions and Energy Mix</strong></h2>
<pre><code>Data Source: Utilize "Table_11.1".

Techniques: Implement scatterplots  and stacked area chart to establish correlations between energy sources and U.S. carbon emissions. Visual representations showcasing the relationship between energy sources and carbon emissions, highlighting the impact of renewable integration on reducing the carbon footprint.</code></pre>
<p>Again, we are only concerned with the most recent 30 years, and we consider the yearly total.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Table_11.1_Carbon_Dioxide_Emissions_From_Energy_Consumption_by_Source.xlsx"</span>, <span class="at">sep.names =</span> <span class="st">" "</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>carbon<span class="sc">$</span>Month <span class="ot">&lt;-</span><span class="fu">as.Date</span>(carbon<span class="sc">$</span>Month, <span class="at">origin =</span> <span class="st">"1899-12-30"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>carbon <span class="ot">&lt;-</span> carbon <span class="sc">|&gt;</span> <span class="fu">filter</span>(Month <span class="sc">&gt;=</span> <span class="st">'1993-01-01'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Month <span class="sc">&lt;</span> <span class="st">'2023-01-01'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>carbon<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">format</span>(carbon<span class="sc">$</span>Month,<span class="st">"%Y"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>yearlycarbon <span class="ot">&lt;-</span> carbon <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">|&gt;</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>energycarbon <span class="ot">&lt;-</span> yearlyenergy <span class="sc">|&gt;</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, <span class="st">`</span><span class="at">Total Fossil Fuels Production</span><span class="st">`</span>, <span class="st">`</span><span class="at">Total Renewable Energy Production</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(yearlycarbon, Year, <span class="st">`</span><span class="at">Total Energy CO2 Emissions</span><span class="st">`</span>), <span class="at">by =</span> <span class="st">'Year'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energycarbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>Production for both fossil fuel and renewable energy seem to display a negative correlation with <span class="math inline">\(CO_2\)</span> emissions, but from the plot with year, it looks like this is just due to increasing trend of production and decreasing trend in <span class="math inline">\(CO_2\)</span> emission.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>energycarbon <span class="ot">&lt;-</span> yearlyenergy <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, <span class="st">`</span><span class="at">Total Fossil Fuels Consumption</span><span class="st">`</span>, <span class="st">`</span><span class="at">Total Renewable Energy Consumption</span><span class="st">`</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(yearlycarbon, Year, <span class="st">`</span><span class="at">Total Energy CO2 Emissions</span><span class="st">`</span>), <span class="at">by =</span> <span class="st">'Year'</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(energycarbon)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>On the other hand, fossil fuel consumption and <span class="math inline">\(CO_2\)</span> emission shows the exact same trend over time, and they have very high correlation. This shows that lower fossil fuel consumption is accompanied by lower <span class="math inline">\(CO_2\)</span> emission.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>carbon_y <span class="ot">&lt;-</span> carbon <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="sc">-</span>Month, mean))</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>carbon_y_melted <span class="ot">&lt;-</span> <span class="fu">subset</span>(carbon_y, <span class="at">select =</span> <span class="sc">-</span><span class="st">`</span><span class="at">Total Energy CO2 Emissions</span><span class="st">`</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>carbon_y_melted <span class="ot">&lt;-</span> carbon_y_melted <span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>Year, <span class="at">names_to =</span> <span class="st">"CO2_source"</span>, <span class="at">values_to =</span> <span class="st">"Emission"</span>)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>carbon_y_melted<span class="sc">$</span>CO2_source <span class="ot">&lt;-</span> <span class="fu">substr</span>(carbon_y_melted<span class="sc">$</span>CO2_source, <span class="dv">1</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We finally aimed to investigate which type of energy production emits the most carbon dioxide, providing directions for future changes in the energy structure.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>carbon_y_melted <span class="sc">%&gt;%</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">str_replace</span>(Year, <span class="st">'Year'</span>, <span class="st">''</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">CO2_source =</span> <span class="fu">as_factor</span>(CO2_source)) <span class="sc">%&gt;%</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>Emission, <span class="at">fill=</span>CO2_source)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_area</span>(<span class="at">position =</span> <span class="st">'fill'</span>, <span class="at">color=</span><span class="st">'grey30'</span>, <span class="at">alpha=</span><span class="fl">0.85</span>) <span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">'CO2 Emission Changes Over Years'</span>,</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">'CO2 Emission'</span>,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">'Year'</span>) <span class="sc">+</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">'white'</span>, <span class="at">color=</span><span class="st">'white'</span>),</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"top"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="1152"></p>
</div>
</div>
<p>We created a stacked area plot to display the proportion of CO2 emissions from each energy production. From this, itâ€™s evident that traditional energy sources, namely coal, petroleum, and natural gas, remain the primary contributors to CO2 emissions. Surprisingly, Motor Gasoline and Distillate Fuel Oil also represent a significant proportion, which is quite striking.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./d3graph.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Interactive graph</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>